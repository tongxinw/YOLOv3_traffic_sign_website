---
layout: post
title: Midway Blog Post
bigimg: /img/yologo_3.jpg
gh-repo: https://github.com/tongxinw/YOLOv3_traffic_sign
tags: traffic_sign yolov3 object_detection
comments: true
---

<div style="text-align:center;">
  <img src="https://miro.medium.com/max/1400/0*QW4v12jc29S6fmAt" alt="Architecture of the CNN">
</div>
<br/>

# Building Darknet and Loading Pretrained Weights

The new network in YOLOv3, Darknet-53, is based on Darknet-19, which is used in YOLOv2, combining with the concept from residual networks. It includes shortcuts connections with more fine-grained information, which performs as a better feature extractor. Also, it has upsampling layers merging with previous feature maps to get more meaningful information. In total, it has 106 layers to perform as a good object detector. We still use Google Colab with free GPUs as our cloud platform. We cloned the darknet from AlexeyAB’s GitHub repository, adjusted it to enable GPU, and then built the network. Since YOLOv3 has already been trained on the COCO dataset with 80 classes, we just loaded the pretrained weights from the official website so that we do not have to train the huge network from scratch and hopefully reduce the training time.

The Method was first proposed by Joseph Redmon et al. from University of Washington in 2015 and has been updated to version 3 in 2018 along with another researcher Ali Farhadi in the paper titled “YOLOv3: An Incremental Improvement”.

Past advanced detection systems such as R-CNN employ region proposal methods. Given an image, such systems first generate potential bounding boxes and then run a classifier on the proposed boxes. Post-processing is used after classification to refine bounding boxes, eliminate duplicate detections, and rescore the boxes based on other objects in the scene. Such complex pipelines are slow and hard to optimize since each individual component needs to be trained separately.

YOLO is a unified detection system. It is based on a single convolutional network Thus, YOLO is more efficient compared to other detection systems. YOLO reasons globally about an image, and thus makes less background errors, in contrast to region proposal-based techniques.

The approach applies a single neural network trained end to end to the full image. “This network divides the image into regions and predicts bounding boxes and probabilities for each region. These bounding boxes are weighted by the predicted probabilities” (Redmon).

For example, the image shown below can be divided into a S * S grid and each cell in the grid are assigned with corresponding class probability map and the system also predicts bounding boxes using dimension clusters and predicts an objectness score for each bounding box using logistic regression. As the result, the class probability map and the bounding boxes with confidences are combined and generate a final detection of bounding boxes and class labels.

<div style="text-align:center;">
  <img src="https://miro.medium.com/max/1400/1*8eGPJMRdeHxxFKV6grSbpw.png" alt="Example">
</div>
<br/>
